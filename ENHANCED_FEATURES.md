# üöÄ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è RAG —Å–∏—Å—Ç–µ–º–∞ —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –∫–∞—á–µ—Å—Ç–≤–∞

## üìã –û–±–∑–æ—Ä –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏–π

–°–∏—Å—Ç–µ–º–∞ –±—ã–ª–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∞ —Å–ª–µ–¥—É—é—â–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏:

### ‚úÖ 1. –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `PerformanceMonitor` - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞, –∏—Ç–µ—Ä–∞—Ü–∏–π, –∫–∞—á–µ—Å—Ç–≤–∞
- `QualityAnalytics` - –∞–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª `rag_quality_log.log`
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤ `rag_metrics.json`

**–ú–µ—Ç—Ä–∏–∫–∏:**
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π —É–ª—É—á—à–µ–Ω–∏—è
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫ –∫–∞—á–µ—Å—Ç–≤–∞ (0.0-0.5, 0.5-0.7, 0.7-0.9, 0.9-1.0)
- Success rate —Å–∏—Å—Ç–µ–º—ã
- –ê–Ω–∞–ª–∏–∑ —á–∞—Å—Ç—ã—Ö –ø—Ä–æ–±–ª–µ–º –∏ —É–ª—É—á—à–µ–Ω–∏–π

### ‚úÖ 2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–∞—á–µ—Å—Ç–≤–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏
- –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏

**–§—É–Ω–∫—Ü–∏–∏:**
```python
monitor.save_metrics()              # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏
monitor.load_metrics()              # –ó–∞–≥—Ä—É–∑–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏
analytics.analyze_query_patterns()  # –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
analytics.get_improvement_recommendations()  # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
```

### ‚úÖ 3. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

**–§–∞–π–ª:** `web_interface.py`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ Streamlit
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–∏—Å—Ç–µ–º—ã (–ø–æ—Ä–æ–≥ –∫–∞—á–µ—Å—Ç–≤–∞, –∏—Ç–µ—Ä–∞—Ü–∏–∏)
- –ü—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- –ì—Ä–∞—Ñ–∏–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –¥–∏–Ω–∞–º–∏–∫–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏

**–ó–∞–ø—É—Å–∫:**
```bash
pip install -r requirements_web.txt
streamlit run web_interface.py
```

### ‚úÖ 4. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `QueryCache` - —É–º–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
- –ö–ª—é—á–∏ –∫—ç—à–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ø—Ä–æ—Å–∞ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å—Ç–µ—á–µ–Ω–∏–µ –∫—ç—à–∞ (24 —á–∞—Å–∞)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–º –∫—ç—à–∞ (–º–∞–∫—Å–∏–º—É–º 1000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ (score ‚â• –ø–æ—Ä–æ–≥–∞)

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞:**
- Hit rate (–ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ–ø–∞–¥–∞–Ω–∏–π)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –∫—ç—à–µ
- –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç–∞—Ä–µ–π—à–µ–≥–æ/–Ω–æ–≤–µ–π—à–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞

### ‚úÖ 5. A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑:**
- –ì–∏–±–∫—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (`quality_threshold`, `max_iterations`)
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–∞–∂–¥–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤
- Batch —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

## üéØ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

### –ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º–æ—Å—Ç—å
```python
quality_rag = QualityControlledRAG(
    vector_store=vector_store,
    llm=llm,
    quality_threshold=0.9,      # –ü–æ—Ä–æ–≥ –∫–∞—á–µ—Å—Ç–≤–∞
    max_iterations=3,           # –ú–∞–∫—Å–∏–º—É–º –∏—Ç–µ—Ä–∞—Ü–∏–π
    enable_monitoring=True,     # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
    enable_caching=True         # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
)
```

### –î–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
```python
# –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –æ —Å–∏—Å—Ç–µ–º–µ
report = quality_rag.get_full_report()

# –û—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
performance = quality_rag.get_performance_report()
cache_stats = quality_rag.get_cache_stats()
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏
```python
# –°–±—Ä–æ—Å –º–µ—Ç—Ä–∏–∫
quality_rag.reset_metrics()

# –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
quality_rag.clear_cache()

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
quality_rag.monitor.save_metrics()
```

## üìä –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç —Å –æ–¥–Ω–∏–º –≤–æ–ø—Ä–æ—Å–æ–º
```python
python query_rag.py
# –í—ã–±—Ä–∞—Ç—å: 1. –û–¥–∏–Ω–æ—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
```

### 2. –ú–∞—Å—Å–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
python query_rag.py
# –í—ã–±—Ä–∞—Ç—å: 2. Batch —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (4 –≤–æ–ø—Ä–æ—Å–∞)
```

### 3. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
```bash
streamlit run web_interface.py
```

### 4. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º
```python
python query_rag.py
# –í—ã–±—Ä–∞—Ç—å: 3. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º
```

## üìà –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

| –ê—Å–ø–µ–∫—Ç | –î–æ —É–ª—É—á—à–µ–Ω–∏–π | –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π |
|--------|--------------|-----------------|
| **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | –ü–æ–ª–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞ | –ú–µ—Ç—Ä–∏–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ |
| **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** | –ù–µ—Ç | –£–º–Ω—ã–π –∫—ç—à —Å 24—á TTL |
| **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å** | –¢–æ–ª—å–∫–æ CLI | Web + CLI |
| **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** | –ù–µ—Ç | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ |
| **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** | –ù–µ—Ç | –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ |

## üõ†Ô∏è –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
Task5_RAG/
‚îú‚îÄ‚îÄ query_rag.py              # –û—Å–Ω–æ–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏
‚îú‚îÄ‚îÄ web_interface.py           # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ requirements_web.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –≤–µ–±–∞
‚îú‚îÄ‚îÄ quality_control_usage.md   # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
‚îú‚îÄ‚îÄ ENHANCED_FEATURES.md       # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ cache/                     # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∫—ç—à–∞
‚îÇ   ‚îî‚îÄ‚îÄ query_cache.json
‚îú‚îÄ‚îÄ rag_quality_log.log        # –õ–æ–≥ —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ rag_metrics.json           # –ú–µ—Ç—Ä–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã
```

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è RAG —Å–∏—Å—Ç–µ–º–∞ —Å:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –∫–∞—á–µ—Å—Ç–≤–∞
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
- ‚úÖ –£–º–Ω—ã–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π
- ‚úÖ –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–º —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –∞–∫—Ç–∞–º!
